<!DOCTYPE html>
<html>
<head>
    <title>Profitability Simulation</title>
    <style>
        .top-right {
            position: absolute;
            top: 20px;
            right: 20px;
        }
        .centered {
            text-align: center;
        }
        .large-font {
            font-size: 2em;
        }
        .medium-font {
            font-size: 1.5em;
        }
        .explanation {
            max-width: 700px;
            margin: 20px auto;
            font-size: 1.1em;
            color: #333;
        }
        /* Fix Notes column width */
        .notes-col {
            width: 250px;
            min-width: 180px;
            max-width: 250px;
            word-break: break-word;
        }
        /* Left-align explanation blocks */
        .explanation-block {
            max-width: 700px;
            margin: 20px auto;
            font-size: 1em;
            color: #444;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="top-right">
        <button onclick="window.location.href='/'">Back to Dashboard</button>
    </div>
    <h1 class="centered">Profitability Simulation</h1>
    <div class="explanation centered">
        This simulation takes into account the current up-to-date Bitcoin prices in two different platforms (European vs Korean), and returns profit & ROI with user-input transaction amount. Put the amount of money you'd like to use for the arbitrage transaction.<br><br>
        The scenario is that you send KRW from a Korean account to buy Bitcoins on a European Bitcoin platform (Bitvavo). For this, you need to transfer money from Korean to European account. Afterwards, you will transfer Bitcoin from the European to the Korean Bitcoin platform (CoinOne), sell it, and make profit. Below shows how much profit and ROI you can expect, and a breakdown of each arbitrage transaction step and how it affects your profitability.
    </div>
    
    <div class="centered" style="margin-top:40px;">
        <h2>Simulation Flow and Fees</h2>
        <table style="margin: 0 auto; border-collapse: collapse; font-size: 1em;">
            <thead>
                <tr>
                    <th style="border:1px solid #ccc; padding:8px;">Step</th>
                    <th style="border:1px solid #ccc; padding:8px;">Description</th>
                    <th style="border:1px solid #ccc; padding:8px;">Fee/Rate</th>
                    <th style="border:1px solid #ccc; padding:8px;">‚è±Ô∏è Estimated Time</th>
                    <th class="notes-col" style="border:1px solid #ccc; padding:8px;">üìò Notes</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="border:1px solid #ccc; padding:8px;">1</td>
                    <td style="border:1px solid #ccc; padding:8px;">Convert KRW ‚Üí EUR via Wise</td>
                    <td style="border:1px solid #ccc; padding:8px;">5,000 KRW + ~0.4% FX spread</td>
                    <td style="border:1px solid #ccc; padding:8px;">0.5 ‚Äì 2 hours</td>
                    <td class="notes-col" style="border:1px solid #ccc; padding:8px;">Wise is generally fast, but cross-border KRW ‚Üí EUR transfers may take longer due to banking hours or compliance checks</td>
                </tr>
                <tr>
                    <td style="border:1px solid #ccc; padding:8px;">2</td>
                    <td style="border:1px solid #ccc; padding:8px;">Deposit EUR to Bitvavo</td>
                    <td style="border:1px solid #ccc; padding:8px;">0 EUR</td>
                    <td style="border:1px solid #ccc; padding:8px;">Instant ‚Äì 1 hour</td>
                    <td class="notes-col" style="border:1px solid #ccc; padding:8px;">If you deposit from a supported EU bank using SEPA Instant, it's often immediate; otherwise, same-day</td>
                </tr>
                <tr>
                    <td style="border:1px solid #ccc; padding:8px;">3</td>
                    <td style="border:1px solid #ccc; padding:8px;">Buy BTC with EUR</td>
                    <td style="border:1px solid #ccc; padding:8px;">0.25% fee + 0.3% slippage</td>
                    <td style="border:1px solid #ccc; padding:8px;">Seconds ‚Äì 2 minutes</td>
                    <td class="notes-col" style="border:1px solid #ccc; padding:8px;">Market buy orders execute almost instantly, but APIs/UI lag or rate limits could slow this slightly</td>
                </tr>
                <tr>
                    <td style="border:1px solid #ccc; padding:8px;">4</td>
                    <td style="border:1px solid #ccc; padding:8px;">Withdraw BTC to CoinOne</td>
                    <td style="border:1px solid #ccc; padding:8px;">0.0005 BTC + 0.0001 BTC network fee</td>
                    <td style="border:1px solid #ccc; padding:8px;">30 ‚Äì 60 minutes</td>
                    <td class="notes-col" style="border:1px solid #ccc; padding:8px;">BTC transfers require confirmations (usually 1‚Äì3) before CoinOne credits your account. Time varies with network fee and congestion</td>
                </tr>
                <tr>
                    <td style="border:1px solid #ccc; padding:8px;">5</td>
                    <td style="border:1px solid #ccc; padding:8px;">Sell BTC on CoinOne</td>
                    <td style="border:1px solid #ccc; padding:8px;">0.1% fee + 0.2% slippage</td>
                    <td style="border:1px solid #ccc; padding:8px;">Seconds ‚Äì 2 minutes</td>
                    <td class="notes-col" style="border:1px solid #ccc; padding:8px;">Like the buy side, this is fast assuming market liquidity and minimal slippage</td>
                </tr>
            </tbody>
        </table>
        <div class="explanation-block">
            <p><b>Estimated Total Time:</b> 2‚Äì5 hours</p>
            <p>‚ö†Ô∏è Times may vary due to banking hours, BTC network congestion, and FX transfer compliance.</p>
            <p><b>Why does execution time matter?</b><br>
            The Korean premium can change significantly over time. If your arbitrage process takes several hours, the premium you see at the start may be very different by the time you finish. Check the premium graphs above to see how much it can fluctuate during the day.</p>
        </div>
    </div>

    <div class="explanation-block">
        <p><b>üè¶ What Is an FX Spread?</b><br>
        When you exchange currencies (e.g. KRW ‚Üí EUR), you're given an exchange rate. But this rate isn‚Äôt always the real ‚Äúmid-market rate‚Äù ‚Äî it includes a markup added by the currency exchange service (like Wise, banks, or credit cards). That markup is called the FX spread.</p>
        <p><b>‚úÖ What is slippage?</b><br>
        Slippage is the difference between the expected price (quoted/market) and the actual execution price of an asset ‚Äî due to: Market volatility, Low liquidity at the target price, Delays in execution</p>
        <p><b>‚ö†Ô∏è Estimated BTC transfer time:</b> 45 minutes (may vary with network conditions)</p>
    </div>

    <h2 class="centered" style="margin-top:50px;">Run Simulation</h2>
    <form id="simForm" class="centered">
        <label for="krwAmount">Amount to Arbitrage (KRW):</label>
        <input type="number" id="krwAmount" value="1000000" min="10000" step="10000">
        <button type="button" onclick="runSimulation()">Simulate</button>
    </form>
    <div id="profitSummary" class="centered" style="margin-top:30px;"></div>
    <div id="simulationResults" style="margin-top:30px;"></div>
    <script src="{{ url_for('static', filename='simulation.js') }}"></script>
</body>
</html>